---
title: "제 8장-카이제곱 통계"
format: html
---

> Reporting Date: October. 5, 2024

질적변수의 분석에  널리 이용되는 다항분포, 카이제곱검정을 소개하고 교차표에 대한 기초적인 분석에 대해 다루고자 한다.

## 01 데이터의 분류

### 1. 양적 데이터
Quantitative Data

관찰 대상의 속성을 수치로 측정할 수 있는 데이터로,
덧셈과 뺄셈 등의 산술 연산이 가능하다.

척도의 성격에 따라 구간 척도와 비율 척도로 구분된다.

① 구간 척도 (Interval Scale)

값들 간의 간격이 일정하다는 특성을 지니며,
절대적 영점이 존재하지 않는다.

따라서 0은 속성의 부재(absence)를 의미하지 않으며,
덧셈과 뺄셈은 가능하지만 곱셈이나 나눗셈을 통한 비율 비교는 무의미하다.

예: 섭씨(°C)와 화씨(°F) 온도. (0°C는 ‘온도가 없음’을 의미하지 않음)

② 비율 척도 (Ratio Scale)

구간 척도의 모든 특성을 지니면서, 절대적 영점이 존재한다.
즉, 0이 속성의 완전한 부재를 의미하므로 사칙연산이 모두 가능하며 '두 배', '절반'과 같은 비율 비교가 가능하다.

예: 연령, 키, 무게, 길이, 소득, 켈빈(K) 온도.



### 2.  질적 데이터
Qualitative Data

수치로 양을 측정하기보다는,
관찰 대상의 속성이나 범주를 나타내는 데이터이다.

이러한 데이터는 주로
구분(classification)이나 서열(ordering)에 초점이 맞추어지며,
척도의 수준에 따라 명목척도와 순서척도로 구분된다.

① 명목 척도 (Nominal Scale)

범주 간에 순서가 존재하지 않으며, 단순한 구분만 가능하다.
각 범주는 상호 배타적이며, 수치적 크기나 간격 비교는 불가능하다.

예: 성별, 출생지, 국적, 혈액형 등.

명목척도 변수는 주로 카이제곱 검정(χ² test)이나 
교차분석을 통해 변수 간의 독립성 또는 연관성을 분석한다.

② 순서 척도 (Ordinal Scale)

범주 간에 자연스러운 순서(rank)가 존재하지만,
인접한 범주 간 간격이 동일하다고 볼 수 없다.

따라서 서열 비교는 가능하나,
차이의 크기를 정량적으로 해석하기는 어렵다.

예: 만족도, 학점, 성적 등급 등.

순서척도 변수 간의 연관성은 주로
순위상관계수(Spearman’s ρ, Kendall’s τ)를 이용해 평가할 수 있다.

## 02 카이제곱 분포
Chi-Square Distribution, χ² 

서로 독립인 표준 정규분포를 따르는 확률변수를 제곱한 뒤
그 합으로 정의되며, 항상 0 이상의 값을 갖는 확률분포이다.
분포 형태는 일반적으로 오른쪽 꼬리가 긴 비대칭을 보인다.

### 1 .  자유도(df)
작을수록 비대칭성이 크며, 평균, 중앙값, 최빈값의 차이가 뚜렷하게 나타난다.
커질수록 분포는 점점 대칭에 가까워지고 정규분포에 근사한다.
분포의 평균은 \(df\)와 같으며, 분산은 \(2 × df\)이다.

### 2 .  통계적 활용
카이제곱 분포는 주로 카이제곱 검정의 기반이 된다.

예: 적합도 검정(goodness-of-fit test)과 독립성 검정(test of independence)에서,
귀무가설이 참일 경우 검정 통계량이 χ² 분포를 따른다고 가정한다.

검정은 주로 분포의 오른쪽 꼬리 영역을 기준으로 수행되며,
계산된 통계량이 해당 영역에 속하면 귀무가설을 기각한다.

따라서 χ² 분포는 데이터가 귀무가설로부터 얼마나 크게 벗어났는지를 평가하는 핵심 도구로 널리 활용된다.



## 03 카이제곱 적합도 검정
Chi-Square Goodness of Fit Test
피어슨의 카이제곱 통계량

단일 범주형 변수에 대해, 실제로 관측된 빈도가
이론적으로 기대되는 빈도와 얼마나 일치하는지를 평가하기 위한 통계적 방법이다.

즉, 주어진 표본이 특정한 이론적 분포인
균등분포, 정규분포, 이항분포 등을 얼마나 잘 따르는지를 검정하는 데 사용된다.

이 검정은 동질성 검정이나 독립성 검정과 달리,
두 변수 간의 관계를 비교하는 것이 아니라

한 변수의 분포 형태 자체가 이론적 가정과 일치하는지를 확인하는 데 초점을 둔다.



로그 우도비 검정통계량
Log Likelihood Ratio Test Statistic

우도비(Likelihood Ratio) 는
두 개의 통계 모형의 적합도를 비교하기 위한 지표이다.

하나는 귀무가설(H₀)​하의 제한된 모형(restricted model),
다른 하나는 대립가설(H₁)하의 포괄적 모형(full model)이다.

우도비 검정의 핵심은
두 모형의 최대우도(maximum likelihood)를 비교하여
대립가설이 데이터를 더 잘 설명하는지를 평가하는 것이며, 정의는 다음과 같다:

\(L(\theta_0):\) 귀무가설 H₀ 하에서의 최대우도
\(L(\hat{\theta}):\) 대립가설 H₁ 하에서의 최대우도

로그 우도의 개념
표본이 \(\{x_1, x_2, \dots, x_n\}\)이고,
모수 \(\theta\) 에 따른 확률밀도(또는 확률질량) 함수가 \(f(x|\theta)\)일 때,
우도 함수는 다음과 같이 정의된다.

 $$L(\theta) = \prod_{i=1}^{n} f(x_i \mid \theta)$$

하지만 이 곱은 표본 크기가 커질수록
수치적으로 매우 작아지므로, 계산의 안정성을 위해 로그를 취한다.

$$
l(\theta) = \log L(\theta) = \sum_{i=1}^{n} \log f(x_i \mid \theta)
$$

이를 로그우도(log-likelihood) 라고 하며, 개별 확률들의 로그값을 모두 더한 형태이다.


로그 우도비 검정통계량
두 모형의 로그우도를 비교하여 검정통계량 \(D\)를 정의한다.

$$
D = -2 \log \left( \frac{L(\theta_0)}{L(\hat{\theta})} \right)
$$

\(D\)의 값이 클수록 대립가설 하의 모형이 데이터를 더 잘 설명한다는 의미이며,
결과적으로 귀무가설을 기각할 가능성이 높아진다.


분포 및 해석
표본의 크기가 충분히 크면,
Wilks의 정리(Wilks’ Theorem) 에 따라 검정통계량 \(D\)는
df가 "두 모형의 추정 파라미터 개수 차이"인 카이제곱 분포(χ²) 를 따른다.

따라서 유의수준 \(\alpha\)를 설정하고,
카이제곱 분포표에서 기준치(critical value)를 찾는다.
만약 계산된 \(D\)가 기준치보다 크면, 귀무가설(H₀)을 기각한다.



### 1 .  멘델의 법칙
멘델의 유전 법칙에 따르면,
특정 형질이 자손에게 전달될 때 일정한 분리비율(segregation ratio) 이 나타난다.

단일 형질의 경우: 우성 대 열성 = 3 : 1,
두 형질이 동시에 관찰될 경우: 9 : 3 : 3 : 1의 기대비율(expected ratio) 이 예측된다.
그러나 실제 실험에서는 표본의 우연한 변동(sampling variation) 으로 인해
관찰된 비율이 이론적으로 기대되는 비율과 정확히 일치하지 않을 수 있다.

이때, 관찰된 빈도와 기대빈도의 차이가 단순한 우연에 의한 것인지,
혹은 통계적으로 유의한 차이인지를 판단하는 방법이 바로 카이제곱(χ²) 적합도 검정이다.

카이제곱 적합도 검정은
관찰빈도와 기대빈도의 차이를 정량적으로 평가하여,
그 차이가 유전법칙에서 제시된 이론적 비율과 통계적으로 일치하는지를 검정한다.

따라서 이 검정은 멘델의 유전 법칙이
실제 실험 데이터와 부합하는지를 검증하는 핵심 통계적 도구로 사용된다.



### 2 .  적합도 검정의 단계
카이제곱 적합도 검정은 다음과 같은 절차로 수행된다.

① 가설 설정
귀무가설(H₀): 관측된 비율은 이론적으로 기대되는 비율과 같다.
대립가설(H₁): 관측된 비율은 기대되는 비율과 다르다.
예: 완두콩의 우성:열성 비율이 3 : 1 이라는 멘델의 가설을 검정한다고 하자.

② 기대도수 계산
총 표본 수에 각 범주의 기대 비율을 곱하여 기대도수를 구한다.

예: 400개의 완두콩 샘플에서 3 : 1 비율을 예상한다면

우성: \(400 \times \frac{3}{4} = 300\)
열성: \(400 \times \frac{1}{4} = 100\)
③ 카이제곱 통계량 계산
관측도수와 기대도수의 차이를 바탕으로 다음 공식을 사용한다.

$$
\chi^2 = \sum \frac{(관측도수 - 기대도수)^2}{기대도수}
$$

④ 자유도(DF) 계산
자유도는 범주의 수 - 1 로 계산한다.

예: 두 범주(우성, 열성)가 있을 때

$$
DF = 2 - 1 = 1
$$

⑤ 결과 해석
계산된 χ² 값을 자유도에 따른 임계값(critical value) 과 비교한다.
만약 \(χ²_{\text{계산값}} > χ²_{\text{임계값}}\)이면, 귀무가설을 기각한다.
반대로, 계산값이 임계값보다 작으면 귀무가설을 기각할 수 없으며,
이는 관측된 비율이 멘델의 법칙(3 : 1 비율)에 부합함을 의미한다.

04 교차분석
이제 질적 변수 간의 연관성을 시각적·수치적으로 확인할 수 있는 도구인 교차표를 살펴본다.



### 1 .  교차표
Contingency Table

두 개 이상의 범주형 변수를 기준으로,
각 범주의 조합이 몇 번 나타나는지를 빈도로 정리한 표.

예: 암의 종류와 성별을 교차하여 각 조합이 몇 번 발생하는지를 나타낼 수 있다.

일반적으로 행(row)과 열(column)로 구성되며,
각 셀(cell)에는 해당 행과 열의 범주 조합에 해당하는 빈도수가 표시된다.

차원은 행과 열의 범주 수에 따라 결정되며,
\(r\)개의 범주를 가진 행과 \(c\)개의 범주를 가진 열이 있을 경우, 표의 크기는 \(r×c\) 가 된다.

이러한 교차표는 변수 간 관계를 시각적으로 파악하고,
카이제곱 검정(χ² test)과 같은 통계적 방법을 통해 변수 간 독립성 여부를 평가하는 데 활용된다.

교차표를 만드는 이유


교차표는 두 개 이상의 범주형 변수 간 관계를 시각적으로 확인하는 도구이다.
이를 통해 각 범주 조합의 빈도를 정리하고, 변수 간 연관성을 탐색할 수 있다.

변수 간 관계를 수치적으로 평가하기 위해 카이제곱 검정을 수행할 수 있다.

카이제곱 검정은 관측 빈도(observed frequency)와
기대 빈도(expected frequency) 간의 차이를 기반으로, 변수 간 독립성 여부를 평가하는 통계적 방법이다.

따라서 교차표는 단순히 빈도를 정리하는 역할을 넘어,
카이제곱 검정을 통해 변수 간 연관성을 정량적으로 검증하는 중요한 기초 자료로 활용된다.

카이제곱 검정의 종류

### 1 .  동질성 검정
Test of Homogeneity

서로 다른 그룹의 범주형 데이터 분포가
동일한지 여부를 평가하는 통계적 방법이다.

예: 암 종류별로 성별 분포가 동일한지를 확인할 때 활용할 수 있다.

가설 설정
귀무가설(H₀): 각 그룹의 분포는 서로 같다.
대립가설(H₁): 각 그룹의 분포는 서로 다르다.


### 2 .  독립성 검정
Test of Independence

두 범주형 변수 간에 독립적인 관계가 성립하는지를 평가하는 통계적 방법이다.

예: 암의 종류와 성별이 서로 독립적인지,
즉 암의 종류가 성별과 관련이 없는지를 확인할 때 활용할 수 있다.

가설 설정
귀무가설(H₀): 두 변수는 서로 독립적이다.
대립가설(H₁): 두 변수는 서로 독립적이지 않다.


### 3 .  검정 절차
검정은 카이제곱 통계량을 기반으로 수행되며,
관측 빈도 \(O_{ij}\) 와 기대 빈도 \(E_{ij}\) 간의 차이를 비교하여 그룹 간 분포의 동일성을 평가한다.

기대 빈도는 각 관측치가 행과 열의 비율대로 분포한다고 가정하여 계산된다.

① 서로 다른 그룹의 범주형 데이터를 수집한다.
② 교차표를 작성한 뒤, 각 셀의 기대 빈도를 계산한다.

③ 카이제곱 통계량을 다음과 같이 계산한다:

$$
\chi^2 = \sum_{i=1}^{r}\sum_{j=1}^{c} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
$$

\(df = (r-1)(c-1)\)
④ 설정한 유의수준 \(α\) 과 비교하여,
통계량이 임계값보다 크면 귀무가설(H₀)을 기각하고, 두 변수는 독립적이지 않다고 판단한다.

그렇지 않으면 귀무가설을 채택하여, 두 변수가 독립적이라고 결론짓는다.

동질성 검정은 독립성 검정과 유사하지만,
독립성 검정은 단일 표본에서 변수 간 관계를 평가하는 반면,
동질성 검정은 서로 다른 집단 간 분포의 동일성을 평가한다는 점에서 차이가 있다.



관찰도수
Observed Frequency, O

실제 데이터에서 측정된 빈도를 의미하며,
연구자가 수집한 자료를 기반으로 각 범주에 속하는 사례 수를 나타낸다.

기대도수
Expected Frequency, E

두 범주형 변수가 독립적일 경우, 각 셀에 기대되는 빈도를 의미한다.

이는 관측된 데이터가 아닌 이론적 계산 값으로,
두 변수 간 관계가 없다고 가정할 때 각 범주에 속할 것으로 예상되는 사례 수를 나타낸다.

기대도수는 다음 공식으로 계산할 수 있다:

$$
E_{ij} = \frac{(\text{행 합계}_i) \times (\text{열 합계}_j)}{\text{전체 합계}}
$$

예: 음주 여부와 암 발생 관계
음주 여부와 암 발생 간의 관계를 조사할 때, 교차표의 각 셀은 다음과 같이 구성된다.

음주자 중 암 발생자 수
음주자 중 암 미발생자 수
비음주자 중 암 발생자 수
비음주자 중 암 미발생자 수
관찰도수와 기대도수는 교차표 작성과 카이제곱 검정 수행에 활용되며,
변수 간 관계를 평가하는 핵심 자료가 된다.



### 4 .  검정의 목적
검정 통계량인 카이제곱 값(χ²)이 클수록
관측 빈도와 기대 빈도의 차이가 크다는 의미이며, 이는 두 변수 간 관계가 존재할 가능성을 시사한다.

따라서 χ² 값이 유의미하게 크면 귀무가설(H₀)을 기각하고, 두 변수 간 관계가 있다고 판단한다.

카이제곱 검정은 독립성 검정과 동질성 검정 모두에서 활용되며,
범주형 데이터의 관계를 분석하는 데 중요한 도구로 사용된다.



### 5 .  충분조건
카이제곱 검정을 적용하기 위해서는 다음과 같은 조건이 충족되어야 한다:

① 기대도수

각 셀의 기대도수는 5 이상이어야 한다.
기대도수가 5 미만인 셀이 전체 셀의 20%를 초과하지 않아야 한다.
이를 충족하지 못하면 검정 결과의 신뢰성이 저하될 수 있다.

예: 연령대별 정치 선호도를 10점 척도로 분석할 경우,
일부 연령대에서 기대도수가 낮아 기준을 만족하기 어려울 수 있으며, 이 경우 연령을 상·중·하 등으로 그룹화해야 한다.

② 표본 크기

표본 크기가 지나치게 작으면 검정력(power)이 낮아져
제2종 오류(Type II error)의 발생 위험이 증가한다.

따라서 실질적으로 의미 있는 차이를 높은 확률로
탐지하려면 충분히 큰 표본을 확보하는 것이 필요하다.

③ 셀 간 균형

범주 간 사례 수가 크게 불균형하면
일부 셀의 기대도수가 낮아지고, 검정 결과가 불안정해질 수 있다.

조사 설계 단계에서 범주별 사례수를 균등하게 확보하는 것이 권장된다.

④ 기대도수 부족 시 대처 방법

범주 통합: 빈도가 낮은 범주를 합쳐 각 셀의 기대도수를 증가시킨다.
범주 재설정: 데이터를 적절히 재범주화하여 기대도수를 확보한다.
기타 범주 생성: 매우 작은 빈도를 가진 범주를 '기타'와 같이 하나로 묶어 분석한다.

---

교제: 파이썬을 활용한 데이터 분석과 응용