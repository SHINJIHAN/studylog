---
title: "제 10장 분산분석: 일원분류"
format: html
---

> Reporting Date: November. 5, 2024

일원분류 분산분석(ANOVA)의 전반적인 내용에 대해 다루고자 한다.

# 01 분산 분석
ANOVA, Analysis of Variance, 분산의 분석

세 개 이상의 그룹 간 평균 차이가
통계적으로 유의미한지를 검정하기 위한 통계 기법이다.

단순한 평균 비교 방법인
t-검정이 두 집단 간 차이만을 다룰 수 있는 데 비해,
분산 분석은 여러 집단을 동시에 비교할 수 있어 경제적이고 효율적이다.

이 방법은 카드사의 지역별 매출 차이, 자동차 모델별 연비 효율,
패션과 스포츠 트렌드의 차이, 혹은 환자의 치료 효과 등 다양한 분야에서 활용된다.

즉, 집단 간의 차이가 단순한 우연의 산물인지,
실제로 의미 있는 차이인지를 판별하는 데 사용된다.

## 1 .  유래와 역사적 배경
1935년, 통계학자 로널드 A. 피셔(Ronald A. Fisher)가
저서 The Design of Experiments에서 처음 체계적으로 제시하였다.

그는 실험 설계법을 통해 통계적 추론의 근거를 마련하였으며,
이후 널리 알려진 붓꽃 데이터(Iris dataset)를 사용하여 그룹 간 평균 차이를 검정하는 절차를 구체적으로 설명하였다.

이 연구는 실험의 무작위화(randomization), 통제(control),
반복(repetition)이라는 세 가지 원칙을 확립함으로써,
현대 통계학의 기초를 세우는 중요한 전환점이 되었다.

피셔는 또한 귀무가설(null hypothesis)과 유의수준(significance level) 개념을 도입하여,
관찰된 차이가 단순한 우연인지 아닌지를 판단하는 통계적 검정의 표준 절차를 확립하였다.


## 2 .  홍차 실험
Tea-tasting experiment

피셔의 통계 사상을 상징적으로 보여주는 사례로,
임의화 실험(randomized experiment)의 효시로 평가된다.

피셔의 비서는 홍차와 우유 중
어느 것을 먼저 넣었는지 맛만으로 구별할 수 있다고 주장했다.

이를 검증하기 위해 피셔는 총 8잔의 홍차를 준비했으며,
이 중 4잔은 홍차를 먼저, 나머지 4잔은 우유를 먼저 넣은 뒤 무작위로 제시했다.

비서가 모든 잔을 완벽히 맞출 필요는 없었고,
통계적으로 유의미한 비율로 구분할 수 있다면 그의 주장이 단순한 우연이 아님을 입증할 수 있었다.

이 사례는 오늘날 우리가 사용하는 “귀무가설을 설정하고,
특정 유의수준에서 이를 기각하는” 가설 검정 절차의 시초로 간주된다.

## 3 .  문화적 일화: 조지 오웰의 홍차론
흥미롭게도, 홍차에 대한 관점은 통계학적 접근 외에도 문화적으로 다양하게 전개되었다.

영국의 작가 조지 오웰(George Orwell)은 1946년 에세이 A Nice Cup of Tea에서
“뜨거운 홍차를 먼저 따르고, 그 후 차가운 우유를 넣는 것이 가장 이상적이다”라고 주장했다.

그는 이 방식이 홍차의 향과 우유의 부드러움을 동시에 살려준다고 설명했다.

피셔가 실험을 통해 ‘객관적 검증’을 중시했다면,
오웰은 경험과 감각을 바탕으로 ‘주관적 완성’을 추구한 셈이다.
이 대비는 과학적 탐구와 문화적 감수성의 공존을 상징적으로 보여준다.

# 02 실험 연구의 개념
Experimental Study, 디자인, 설계

특정 요인이 결과 변수에 미치는 영향을
체계적으로 검증하기 위한 연구 설계 방법이다.

이는 연구자가 요인을 의도적으로 조작(control)하고,
그에 따른 결과 변화를 관찰(observation)함으로써 인과관계를 명확히 밝히는 데 목적이 있다.

예를 들어, 농작물의 수확량에 영향을 미치는 다양한 요소를 분석하기 위해 다음과 같은 가설을 설정할 수 있다.



가설: 비료의 종류와 정화수의 온도에 따라 수확량의 차이가 존재하는가?
이 가설을 검증하기 위해 실험을 구성할 때는 주요 개념을 명확히 정의해야 한다.


## 1 .  반응변수
Response Variable

실험의 결과로 측정되는 변수로,
요인의 변화에 따라 값이 달라지는 종속변수이다.

본 실험에서는 수확량(Yield)이 반응변수로 설정된다.
이는 각 실험 조건(비료와 온도 조합)에 따라 달라질 수 있으며, 연구의 주된 분석 대상이 된다.



## 2 .  요인
Factor

실험에서 반응변수에 영향을 줄 수 있는 독립변수를 의미한다.
연구자는 요인을 조작하여 각 수준별로 반응변수의 변화를 관찰한다.

본 실험에서는 비료의 종류와 정화수의 온도가 두 개의 요인이다.
각 요인의 효과를 분리하여 비교함으로써, 어떤 요인이 수확량에 더 큰 영향을 미치는지 파악할 수 있다.



## 3 .  수준
Level

각 요인이 취할 수 있는 구체적인 값 또는 조건을 의미한다.
하나의 요인은 여러 수준을 가질 수 있으며, 수준의 조합을 통해 다양한 실험 처리가 구성된다.

비료 요인: A, B, C → 3개 수준
정화수 온도 요인: 10 °C, 15 °C, 20 °C → 3개 수준
이처럼 요인의 수준 수가 많아질수록 가능한 처리 조합의 수도 기하급수적으로 증가한다.



## 4 .  처리 또는 처치
Treatment

요인들의 수준 조합에 의해 형성되는 구체적인 실험 조건을 의미한다.
즉, 각 처리는 서로 다른 조건하에서 실험이 수행되는 개별 실험 단위를 나타낸다.

(비료 A, 온도 10 °C)
(비료 B, 온도 15 °C)
(비료 C, 온도 20 °C)
각 조합은 하나의 독립적인 처리이며,
처리별 수확량을 비교함으로써 요인의 효과를 통계적으로 분석할 수 있다.




개념	예시
반응변수	실험의 결과로 관찰되는 값	수확량
요인	반응변수에 영향을 주는 독립변수	비료 종류, 정화수 온도
수준	요인의 구체적 조건	비료 A/B/C, 온도 10 / 15 / 20 °C
처리	요인 수준의 조합	(비료 A, 10 °C), (비료 B, 15 °C) 등

실험 연구 과정


03 실험 설계의 기본 원리
Principles of Experimental Design

실험 설계의 목적은 요인의 효과를 정확하게 추정하고,
불필요한 오차를 최소화하는 것에 있다.

이를 달성하기 위해 통계학자 로널드 A. 피셔(Ronald A. Fisher)는
세 가지 기본 원리 ― 반복화(Replication), 확률화(Randomization), 블록화(Blocking) ― 를 제시하였다.

이 세 원리는 현대 모든 실험 설계의 기초로 사용되며, 분산 분석의 이론적 기반을 이룬다.


## 1 .  반복화
Replication

동일한 실험 처리를 여러 번 반복하여 수행하는 절차를 말한다.

실험 단위는 완전히 동일하지 않기 때문에,
실험 오차(experimental error)가 항상 존재한다.

따라서 동일한 조건하에서 실험을 반복함으로써
오차의 크기를 추정하고, 결과의 신뢰도를 높일 수 있다.

각 반응값(response value)은 확률변수로 간주되므로,
반복 측정을 통해 변이(variation)를 관찰할 수 있다.

이를 통해 평균 반응의 안정성과 분산의 크기를 평가할 수 있으며,
이는 F-검정의 분모에 해당하는 오차항(Mean Square Error) 추정에 직접적으로 기여한다.

비료 A와 온도 15 °C의 조합을 세 번 반복 측정할 경우,
수확량의 평균뿐 아니라 변동성까지 고려한 신뢰성 있는 결론을 얻을 수 있다.



## 2 .  확률화
Randomization

실험 단위에 각 처리(조건)를
무작위로 배정(random assignment) 하는 절차이다.

확률화를 통해 연구자의 의도나 외부 환경 요인에 의한 편향(bias)이 최소화된다.
즉, 각 실험 단위가 특정 처리에 배정될 확률이 동일하게 유지되므로,
관찰된 차이는 요인 자체의 효과로 해석할 수 있다.

확률화는 통계적 추론의 전제인 독립성(independence)을 확보하고,
실험 결과에 대한 통계 검정의 정당성을 보장한다.

농지의 위치, 토양의 질, 일조량 등 통제하기 어려운 요인이 존재할 때,
처리 배정을 무작위로 수행하면 이러한 외부 요인의 체계적 영향이 결과에 편향을 일으키는 것을 방지할 수 있다.



## 3 .  블록화
Blocking

비슷한 특성을 지닌 실험 단위를 묶어 동질적인 블록(block)을 형성한 후,
각 블록 내에서 실험 처리를 배정하는 방법이다.

블록화의 목적은 요인 이외의 변동 요인을 통제하여
실험의 정밀도(precision)를 향상시키는 것이다.

즉, 블록 내에서는 실험 단위 간 차이가 최소화되므로,
관찰된 차이는 요인 효과로 더 정확히 설명될 수 있다.

블록은 하나의 보조 요인(nuisance factor)으로 간주되어,
분산 분석 시 오차 제곱합(Error Sum of Squares)을 줄이고
요인 효과의 추정 오차를 감소시킨다.

농지의 일조량이 다를 경우, 일조량 수준이 유사한 구역을 하나의 블록으로 묶은 뒤,
각 블록 내에서 비료 종류를 무작위로 배정하면 요인 효과를 보다 정확히 평가할 수 있다.

세 가지 원리는 서로 독립적이지만 상호보완적으로 작용한다.

원리	목표	주요 효과
반복화 (Replication)	실험 오차 추정 및 결과의 신뢰성 확보	변이 분석 가능, 평균 안정화
확률화 (Randomization)	편향 제거 및 독립성 확보	결과의 타당성 향상
블록화 (Blocking)	외부 요인 통제 및 정밀도 향상	오차 감소, 요인 효과의 명확화


# 04 일원분류 분산분석
One-Way ANOVA

하나의 요인이 반응변수에 미치는 영향을 분석하기 위한 통계적 기법이다.
즉, 하나의 요인에 대해 여러 수준 또는 집단 간의 평균 차이가 존재하는지를 검정한다.

예를 들어, 서로 다른 세 종류의 비료(A, B, C)가
작물의 수확량에 미치는 영향을 비교하고자 할 때,

각 비료 그룹의 평균 수확량이 통계적으로 동일한지
여부를 판단하는 것이 일원분류 분산분석의 목적이다.


 1 .  가설의 설정
일원분류 ANOVA의 기본 가설은 다음과 같이 정의된다.

귀무가설 (H₀): 모든 집단의 평균이 같다.

$$
H_0 : \mu_1 = \mu_2 = \mu_3 = \dots = \mu_k
$$

대립가설 (H₁): 적어도 하나의 집단 평균은 다르다.

$$
H_1 : \text{적어도 한 } \mu_i \text{ 가 다름}
$$

이때, 대립가설은 구체적으로 어느 집단 간의 차이가 있는지를 명시하지 않으며,
단지 ‘평균 간 차이가 존재한다’는 전체적 효과를 검정한다.



## 2 .  ANOVA의 필요성
두 집단 간의 평균 비교는 t-검정으로 충분하다.
그러나 세 집단 이상을 비교할 때 t-검정을 반복 적용하면 누적된 유의수준(α) 문제가 발생한다.

예를 들어, 유의수준 α = 0.05로 세 집단을 비교하는 경우,
서로 다른 세 쌍의 평균 비교가 필요하다.

$$
1 - (1 - 0.05)^3 \approx 0.14
$$

즉, 전체적으로 약 14% 확률로 잘못된 기각(제1종 오류)이 발생할 수 있다.
이는 실제로 차이가 없음에도 불구하고 유의미한 차이가 있다고 잘못 판단할 위험을 높인다.


## 3 .  분산분석의 원리
ANOVA는 단순히 평균 차이를 직접 비교하지 않고,
총 변동(Total Variation)을 다음 두 가지로 분해하여 비교한다.

$$
\text{총제곱합} = \text{집단 간 제곱합 (SSB)} + \text{집단 내 제곱합 (SSW)}
$$

집단 간 제곱합 (Between-group variance):
각 집단 평균 간의 차이에서 기인한 변동, 즉 요인의 효과를 나타낸다.

집단 내 제곱합 (Within-group variance):
같은 집단 내에서의 개별 오차로 인한 변동을 의미한다.

이 두 변동의 비율을 이용해 계산되는 통계량이 F-통계량이다.

$$
F = \frac{\text{집단 간 평균제곱 (MSB)}}{\text{집단 내 평균제곱 (MSW)}}
$$

이 값이 F분포 상에서 임계값보다 크면, 집단 간 평균 차이가 통계적으로 유의하다고 판단한다.


## 4 .  해석의 의미
ANOVA의 결과, 귀무가설이 기각된다면 " 적어도 하나의 집단 평균이 다르다 " 는 결론을 내릴 수 있다.
다만, 어떤 집단 간의 차이가 존재하는지는 알 수 없으므로, 그 이후에는 사후검정(Tukey HSD, Duncan, Scheffé 검정 등) 을 통해 집단 간 세부 비교를 수행해야 한다.

# 05 분산분석표 해석
ANOVA Table

비료는 본 실험에서 단일 요인이며, 이 요인은 총 k개의 처리 또는 수준으로 구성된다.
각 처리는 서로 다른 비료 종류를 의미하며, 이에 따라 반응변수(수확량)의 변화가 관측된다.

## 1 .  반응값 구조와 표본평균
반응값 ( y )는 각 실험 단위에서 관측된 수확량을 의미한다.
비료 ( i )에 대해 ( n )번 반복 측정했다면, ( y_{i1}, y_{i2}, \dots, y_{in} ) 이 수집된다.

예: - ( y_{11} ): 1번 비료의 첫 번째 실험에서 얻은 수확량
각 비료에 대해 반복 측정된 반응값을 평균 내면 표본평균 \(\bar{y}_i\)이 계산된다.

## 2 .  ANOVA의 귀무가설
일원분류 ANOVA의 귀무가설은 다음과 같다.

$$
H_0 : \mu_1 = \mu_2 = \cdots = \mu_k
$$

즉, 비료 종류가 달라도 모평균 수확량은 동일하다고 가정한다.
이는 모든 비료 효과가 0이라는 의미에 해당한다.
반면, 어느 하나라도 다른 경우 대립가설 (H_1)이 성립한다.


## 3 .  제곱합의 의미
Sum of Squares

일원분류 분산분석(ANOVA)은 전체 변동을 처리 간 변동과 처리 내 변동으로 분해한다.
이는 요인(예: 비료 종류)이 반응변수(수확량)에 미치는 영향을 확인하기 위한 핵심 구조이다.

(1) 총제곱합(TSS, Total Sum of Squares)

$$
TSS = \sum_{i=1}^{k}\sum_{j=1}^{r} (y_{ij}-\bar{y})^2
$$

모든 관측값이 전체 평균에서 얼마나 벗어나는지 보여준다.
실험에서 관측된 **전체 변동(total variability)**을 의미하며, 이후 처리 효과와 오차 변동으로 분해된다.
(2) 처리제곱합(SST, Treatment Sum of Squares)

$$
SST = r\sum_{i=1}^{k}(\bar{y}_i - \bar{y})^2
$$

각 처리 평균이 전체 평균에서 얼마나 떨어져 있는지를 측정한다.
반복수 ( r )을 곱함으로써 각 처리 평균이 전체 변동에 기여하는 정도를 반영한다.
비료별 평균 차이가 클수록 SST가 커지며, 이는 처리 효과가 클 가능성을 의미한다.
해석:

SST가 크면 → 처리 간(비료 간) 평균 수확량 차이가 크다 → 대립가설 지지 가능성 증가
SST가 작으면 → 비료 간 차이가 거의 없다
(3) 오차제곱합(SSE, Error Sum of Squares)

$$
SSE = \sum_{i=1}^{k}\sum_{j=1}^{r}(y_{ij}-\bar{y}_i)^2
$$

동일한 처리 내에서 개별 관측값들이 처리 평균에서 벗어나는 정도를 나타낸다.
내부 변동(within-group variability), 즉 실험 통제로 해결되지 않는 자연적·비체계적 변동을 의미한다.
SSE가 작을수록 처리군 내부의 일관성이 높아지고, 처리 효과 검정의 민감도가 상승한다.
(4) 제곱합의 관계

$$
TSS = SST + SSE
$$

전체 변동이 처리 간 차이(SST)
처리 내 오차(SSE) 로 구성됨을 의미한다.
이는 일원분류 ANOVA 전체 구조의 토대이다.



 4 .  처리제곱합의 해석 관점
처리제곱합의 해석은 다음 원칙에 기반한다.

SST가 작다면, 모든 처리 평균이 서로 유사하여
실험을 통해 구분할 만한 차이가 존재하지 않음을 의미한다.

SST가 상대적으로 크고 SSE가 작다면,
처리 간 차이가 오차 변동보다 충분히 크다는 뜻이며,
ANOVA에서 유의한 결과가 나올 가능성이 높아진다.

최종 판단은 다음을 충족할 때 이루어진다.
SST가 크고 SSE가 작으며
계산된 F 통계량이 유의수준에서 임계값을 초과할 때
이 경우 처리 간 평균 차이가 통계적으로 유의하다고 결론 내릴 수 있다.



 5 .  오차의 특성
ANOVA의 F 검정이 타당하려면 다음 오차 구조를 충족해야 한다.

등분산성(homoscedasticity): 각 처리 집단의 오차 분산이 동일
정규성(normality): 오차항이 정규분포를 따름
독립성(independence): 관측값 간 종속 구조가 없음
이 조건이 충족될 때, 계산된 F-통계량은 이론적 F-분포와 부합한다.



 6 .  F-검정의 구조
ANOVA의 목적은 다음 귀무가설을 검정하는 것이다.

$$H_0: \tau_1 = \tau_2 = \cdots = \tau_k = 0$$

즉, 모든 처리 평균이 동일하다는 가설이다.

평균제곱(MS)을 기반으로 F 통계량을 계산한다.

$$F = \frac{MS_{treatment}}{MS_{error}}$$

처리 평균제곱: \(MS_{treat} = \frac{SST}{k-1}\)
오차 평균제곱: \(MS_{error} = \frac{SSE}{k(r-1)}\)
F-값이 클수록 처리평균이 동일하다는 귀무가설을 기각하고 처리 효과가 존재한다는 결론을 얻는다.



 7 .  추가 설명
반복수 ( r )이 동일하지 않아도(불균형 설계),
제곱합과 자유도 계산만 조정되며 분석의 논리는 변하지 않는다.
F-분포는 오른쪽이 긴 비대칭 분포이며, 제곱항 기반이므로 음수 값이 존재하지 않는다.



06 모형 설정의 목적과 구조


일원분류 ANOVA를 기준으로 한다.

 1 .  모델을 세우는 이유
비료 종류가 수확량에 어떤 영향을 주는지를 정량적으로 파악하기 위해서는
관측된 수확량을 처리 효과(비료의 영향)와 오차(통제 불가능한 변동)로 명확히 분리할 필요가 있다.

모형화(Modeling)는 다음 두 가지 목적을 가진다.

처리 효과와 오차를 구분하여 변동의 원인을 구조적으로 이해한다.
비료 간 차이가 통계적으로 유의한지 검정할 수 있는 기반을 제공한다.
즉, 모델을 세움으로써 각 비료가 수확량에 미치는 효과를 체계적으로 설명하고 추론할 수 있다.


 2 .  모형의 기본 구조
일원분류 ANOVA에서는 개별 수확량 \( y_{ij} \)를 다음과 같이 분해한다.

$$y_{ij} = \mu_i + \epsilon_{ij}$$

여기서

\( i = 1, 2, \dots, k \): 비료 종류(처리 수준)
\( j = 1, 2, \dots, n \): 반복 실험 번호
\( \mu_i \): i번째 비료의 모평균 (각 처리에 대한 모평)
\( \epsilon_{ij} \): 개별 수확량의 오차항(Error term)


 3 .  처리 평균의 분해: 전체 평균과 처리 효과
처리별 모평균 \( \mu_i )\는 다시 다음과 같이 표현된다.

$$\mu_i = \mu + \tau_i$$

\( \mu \) : 전체 모평균(overall mean) (모든 비료에 대한 평균)
\( \tau_i \) : i번째 처리(비료)의 효과(treatment effect)
그리스 알파벳 타우(τ)로 표기 (19번째 글자)
전체 평균에서 벗어난 정도를 의미
즉, 각 처리의 평균은 전체 평균 위에 얼마나 효과가 더해졌는가를 나타낸다.



 4 .  최종 모형의 형태
위 식을 결합하면 개별 수확량은 다음과 같이 분해된다.

$$y_{ij} = \mu + \tau_i + \epsilon_{ij}$$

이 모형은 다음의 세 구성요소로 수확량을 설명한다.

전체 모평균(μ)
비료의 처리 효과(τᵢ)
설명되지 않는 변동(오차, εᵢⱼ)


 5 .  오차항의 가정
오차항 \( \epsilon_{ij} \)는 ANOVA의 핵심 가정에 따라 다음을 만족한다.

$$
\epsilon_{ij} \sim N(0, \sigma^2)
$$

평균 0
분산 \( \sigma^2 \)
정규분포를 따르며
서로 독립
이러한 가정이 충족되어야 F-검정이 타당하게 동작한다.



 6 .  모델 설정의 의의
이 모형을 사용하면 다음이 가능해진다.

각 비료의 효과(τᵢ)가 0인지 검정하여
비료 종류가 수확량에 유의한 차이를 만드는지 평가
처리 효과와 오차가 분리되므로
변동의 원인을 구조적으로 해석
분산분석표(ANOVA Table)에서
제곱합 → 평균제곱 → F값 으로 이어지는 분석 구조 확립
결과적으로, 이 모형은 비료 간 평균 차이가 단순한 우연인지,
실제 효과인지 판단할 수 있는 통계적 기반을 형성한다.

필요하면 이어서 모형의 제약조건(∑τᵢ = 0),
모수추정(OLS 관점), F 검정 유도 과정도 전문적으로 정리해드립니다. (흠...)

64 = 72 + (-8) = 전체 모평균 + 오

---

교제: 파이썬을 활용한 데이터 분석과 응용